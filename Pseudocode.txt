BEGIN Program

    DISPLAY "Welcome to Greg's Maths Test!"

    DISPLAY "Select a difficulty:"
    DISPLAY "1) Easy"
    DISPLAY "2) Medium"
    DISPLAY "3) Hard"

    REPEAT
        INPUT difficulty_choice
        IF difficulty_choice = "1" THEN
            num_questions ← 5
            max_num ← 10
            DISPLAY "Easy mode selected!"
            EXIT LOOP
        ELSE IF difficulty_choice = "2" THEN
            num_questions ← 10
            max_num ← 20
            DISPLAY "Medium mode selected!"
            EXIT LOOP
        ELSE IF difficulty_choice = "3" THEN
            num_questions ← 15
            max_num ← 50
            DISPLAY "Hard mode selected!"
            EXIT LOOP
        ELSE
            DISPLAY "Invalid choice! Enter 1, 2 or 3."
        END IF
    UNTIL valid choice

    score ← 0
    correctness_list ← empty list
    time_list ← empty list

    FOR q_number FROM 1 TO num_questions DO
        DISPLAY "Score: ", score
        DISPLAY "Question ", q_number, " of ", num_questions

        IF q_number = num_questions THEN
            DISPLAY "Challenge question!"
            num1 ← RANDOM(max_num, max_num * 2)
            num2 ← RANDOM(max_num, max_num * 2)
        ELSE
            num1 ← RANDOM(max_num // 2, max_num)
            num2 ← RANDOM(max_num // 2, max_num)
        END IF

        operator ← RANDOM CHOICE from ["+", "-"]

        IF operator = "-" AND num2 > num1 THEN
            SWAP num1 and num2    // ensures positive answer
        END IF

        question ← CONCAT(num1, operator, num2)

        START timer
        PROMPT "What is ", question, "?"
        user_answer ← INPUT as INTEGER
        STOP timer

        time_taken ← END_TIME - START_TIME
        correct_answer ← EVALUATE(question)

        IF user_answer = correct_answer THEN
            correctness_list.APPEND(True)
            points_awarded ← MAX(10 - time_taken, 1)
            score ← score + points_awarded
            DISPLAY "Correct! Answered in ", time_taken, 
                    " second(s) - ", points_awarded, " point(s)."
        ELSE
            correctness_list.APPEND(False)
            DISPLAY "Incorrect! Answered in ", time_taken, 
                    " second(s) - no points awarded."
        END IF

        time_list.APPEND(time_taken)

    END FOR

    total_correct ← COUNT of True in correctness_list
    percentage_correct ← ROUND((total_correct / num_questions) * 100)
    avg_time ← ROUND(SUM(time_list) / LENGTH(time_list))

    DISPLAY "Results:"
    DISPLAY "Final score: ", score
    DISPLAY "Correct answers: ", percentage_correct, "%"
    DISPLAY "Average response time: ", avg_time, "s"

    DISPLAY "Breakdown:"
    DISPLAY "Question   Correct   Time"
    FOR i FROM 1 TO num_questions DO
        IF correctness_list[i] = True THEN
            correct_str ← "Yes"
        ELSE
            correct_str ← "No"
        END IF
        DISPLAY i, correct_str, time_list[i], "s"
    END FOR

END Program
